# varsom-observation

# A web component for showing natural hazard observations

## **Installation**
1. Install node.js v18.13.0 or newer
2. Install Visual Studio Code
3. Clone repo (https://github.com/NVE/observasjonskort.git)
4. Open terminal and run "cd .\observasjonskort\"
5. Install jquery: "npm install @types/jquery@latest"
6. Install packages: "npm install"
7. Test locally with "npm start"
<br>

### **Initialize the component**
The component has to be initialized in the index.html-file. Initialize the component with desired props inside the body-tag.
Here is an example: <br>
\<varsom-observation type="Ice" regid="" count=5  language="en"\>\</varsom-observation\> <br><br>
To show plots for ice thickness you must include these scripts and stylesheet:<br>
\<script type="text/javascript" src="https://plot.regobs.no/v1/js/plott-en-istykkelse-www-regobs-no.js"\>\</script\><br>
\<script type="text/javascript" src="https://plot.regobs.no/v1/js/jquery-1.11.1.min.js"\>\</script\><br>
\<script type="text/javascript" src="https://plot.regobs.no/v1/js/jquery.jqplot.min.js"\>\</script\><br>
\<script type="text/javascript" src="https://plot.regobs.no/v1/js/jqplot.canvasOverlay.min.js"\>\</script\><br>
\<script type="text/javascript" src="https://plot.regobs.no/v1/js/jqplot.canvasTextRenderer.min.js"\>\</script\><br>
\<script type="text/javascript" src="https://plot.regobs.no/v1/js/jqplot.canvasAxisLabelRenderer.min.js"\>\</script\><br>
\<link rel="stylesheet" type="text/css" href="https://plot.regobs.no/v1/css/jquery.jqplot.min.css" /\>

<br><br>

## **Storybook**
Storybook can be used to test and demonstrate the component and each child component, using different inputs (props).
To run storbybook, you must first build the project. Run:
1. npm run build
2. npm run storybook (you may have to run "$env:NODE_OPTIONS = "--openssl-legacy-provider") first.

The main component is "varsom-observation". Props you can test the component with is type, count, language and regid (id for the observation).

The prop "count" in the main component must be set to 1 if a regid is set.

To show multiple observations without a spesific hazard type, set type to blank.

The child components have some example data from the regobs-api. The chils components do not have language prop.


<br>

### **Chromatic**
Stobybook can be published to Chromatic. Sign up for Chromatic (https://www.chromatic.com/start?startWithSignup=true) and create a project. 
Replace secret token under scripts in package.json with your project token from Chromatic. Project token should be kept in a safe place, e.g. Github Secrets. 
When project token is set, run:
1. npm run build-storybook
2. npm chromatic

You can share you storybook with others. Make sure the project is set to public if you want to share it with people outside your organization. To get a link to share you stories, use Permalink which you can find under Manage - Collaborate.

<br>

## **Testing** ##
We use Ponicode for testing based on AI. To use Ponicode, you must include 
"import fetch from "node-fetch";" in utils.ts. The import is commented out as default, bacause the project will not build with node-fetch imported. To test methods with Ponicode, press "Ponicode: Unit test" over the method signature. Then you can test the method with input and expected output. The test is then auto generated by Ponicode. Ponicode can also suggest tests with input and expected output for simple methods.
<br>

## **Distribute component to npm**
not implemented

## **Import component from npm**
not implemented

## **Import component in a Vue project**
not implemented

## **Import component in a React project**
not implemented

